# Service Vitals å®Œæ•´é…ç½®ç¤ºä¾‹
# ------------------------------
# å¤åˆ¶æœ¬æ–‡ä»¶å¹¶æ ¹æ®å®é™…éœ€æ±‚ä¿®æ”¹å³å¯ã€‚
# æ”¯æŒåœ¨å­—ç¬¦ä¸²ä¸­ä½¿ç”¨ ${ENV_VAR_NAME} å¼•ç”¨ç¯å¢ƒå˜é‡ã€‚

[global]
# é»˜è®¤é£ä¹¦ Webhook URLï¼ˆå¯é€‰ï¼Œå•ç‹¬æœåŠ¡å¯è¦†ç›–ï¼‰
# default_feishu_webhook_url = "https://open.feishu.cn/open-apis/bot/v2/hook/your-webhook-token"

# æ¶ˆæ¯æ¨¡æ¿ï¼ˆå¯é€‰ï¼ŒHandlebars è¯­æ³•ï¼‰
# å¯ä½¿ç”¨å ä½ç¬¦ï¼š{{service_name}}ã€{{service_url}}ã€{{status_code}}ã€{{response_time}}ã€{{timestamp}}ã€{{error_message}}
message_template = """
ğŸš¨ **æœåŠ¡å‘Šè­¦**
- **æœåŠ¡åç§°**: {{service_name}}
- **æœåŠ¡URL**: {{service_url}}
- **çŠ¶æ€ç **: {{#if status_code}}{{status_code}}{{else}}N/A{{/if}}
- **å“åº”æ—¶é—´**: {{response_time}}ms
- **æ£€æµ‹æ—¶é—´**: {{timestamp}}
{{#if error_message}}
- **é”™è¯¯ä¿¡æ¯**: {{error_message}}
{{/if}}
"""

# å…¨å±€æ£€æµ‹é—´éš”ï¼ˆç§’ï¼‰
check_interval_seconds = 60

# æ—¥å¿—çº§åˆ«ï¼šdebug | info | warn | error
log_level = "info"

# HTTP è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
request_timeout_seconds = 10

# æœ€å¤§å¹¶å‘æ£€æµ‹æ•°
max_concurrent_checks = 100

# å¤±è´¥é‡è¯•æ¬¡æ•°
retry_attempts = 3

# é‡è¯•é—´éš”ï¼ˆç§’ï¼‰
retry_delay_seconds = 5

# å¯é€‰çš„å…¨å±€è¯·æ±‚å¤´ï¼ˆé”®å€¼å¯¹ï¼‰
[global.headers]
"User-Agent" = "ServiceVitals/1.0"
"Accept" = "application/json"

# ------------------------------
# æœåŠ¡åˆ—è¡¨
# ------------------------------

[[services]]
# å¿…å¡«ï¼šæœåŠ¡åç§°
name = "ä¸»ç«™API"

# å¿…å¡«ï¼šæœåŠ¡å¥åº·æ£€æŸ¥ URL
url = "https://api.example.com/health"

# å¯é€‰ï¼šHTTP æ–¹æ³•ï¼ˆé»˜è®¤ GETï¼‰
method = "GET"

# å¿…å¡«ï¼šæœŸæœ›çš„ HTTP çŠ¶æ€ç åˆ—è¡¨
expected_status_codes = [200, 201]

# å¯é€‰ï¼šæœåŠ¡ä¸“å±é£ä¹¦ Webhook URL
feishu_webhook_url = "https://open.feishu.cn/open-apis/bot/v2/hook/service-specific-token"

# å¯é€‰ï¼šå¤±è´¥é˜ˆå€¼ï¼ˆå½“è¿ç»­å¤±è´¥æ¬¡æ•° >= è¯¥å€¼æ—¶è§¦å‘å‘Šè­¦ï¼‰
failure_threshold = 2

# å¯é€‰ï¼šæœåŠ¡ç‰¹å®šæ£€æµ‹é—´éš”ï¼ˆç§’ï¼‰ï¼Œè‹¥ä¸è®¾ç½®åˆ™ä½¿ç”¨å…¨å±€å€¼
check_interval_seconds = 60

# å¯é€‰ï¼šæ˜¯å¦å¯ç”¨è¯¥æœåŠ¡ï¼ˆé»˜è®¤ trueï¼‰
enabled = true

# å¯é€‰ï¼šæœåŠ¡æè¿°
description = "ä¸»ç«™ API å¥åº·æ£€æµ‹"

# å¯é€‰ï¼šå‘Šè­¦æœ€å°é—´éš”ï¼ˆç§’ï¼Œæ—¶é—´é€€é¿ï¼Œé»˜è®¤60ï¼‰ï¼Œå³ä¸¤æ¬¡å‘Šè­¦ä¹‹é—´çš„æœ€å°æ—¶é—´
alert_cooldown_secs = 60

# å¯é€‰ï¼šè¯·æ±‚ä½“ï¼ˆä»… POST/PUT/PATCH ç­‰æ–¹æ³•éœ€è¦ï¼‰
# body = { "key" = "value" }

# æœåŠ¡ä¸“å±è¯·æ±‚å¤´
[services.headers]
"Authorization" = "Bearer ${API_TOKEN}"
"Content-Type" = "application/json"

# ---- ç¬¬äºŒä¸ªç¤ºä¾‹æœåŠ¡ ----

[[services]]
name = "æ•°æ®åº“æœåŠ¡"
url = "https://db.example.com/ping"
method = "GET"
expected_status_codes = [200]
# æœªè®¾ç½® feishu_webhook_urlï¼Œä½¿ç”¨å…¨å±€æˆ–ç¬¬ 1 ä¸ªæœåŠ¡çš„é»˜è®¤
failure_threshold = 1
enabled = true
description = "æ•°æ®åº“è¿æ¥æ£€æµ‹"
alert_cooldown_secs = 60 # ä¾‹å¦‚æ•°æ®åº“æœåŠ¡å‘Šè­¦æœ€å°é—´éš”1åˆ†é’Ÿ

# (å¯é€‰) æœåŠ¡ç‹¬ç«‹è¯·æ±‚å¤´
# [services.headers]
# "X-Custom-Header" = "value"
